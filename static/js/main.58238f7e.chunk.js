(this["webpackJsonptension-wrench"]=this["webpackJsonptension-wrench"]||[]).push([[0],{130:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n(41),r=n.n(s),i=n(185),o=n(194),c=n(11),l=n(203),h=n(200),d=n(205),u=n(204),m=n(197),j=n(192),b=n(201),p=n(190),g=n(199),f=n(202),x=n(198),y=n(96),O=Object(y.a)({palette:{mode:"light"}}),v=n(92),w=n.n(v),k=n(0);function A(e){return Object(k.jsx)(m.a,{variant:"outlined",sx:{mb:1,p:.5,px:1.5},children:Object(k.jsxs)(x.a,{sx:{mt:1,mb:1},color:"text.secondary",children:[Object(k.jsx)(w.a,{sx:{mr:1,verticalAlign:"middle"}}),e.children]})})}function S(){return Object(k.jsxs)(a.Fragment,{children:[Object(k.jsx)(x.a,{variant:"h6",gutterBottom:!0,children:"Welcome!"}),Object(k.jsx)("p",{children:"This tool will help you think about how attackers might probe a software system that you are building. Once you describe a few things about your project, Tension Wrench will generate a discussion guide use can use with your team to start thinking about what attackers might try in order to break in and ways to stop them."}),Object(k.jsx)("p",{children:"Keep your critical thinking hat on! You and your team are the experts about what you are building - this tool can't and won't tell you specifically how to secure it. What it can do is walk you and your team through a list of things to think about, but it's up to you to brainstorm and think critically about what risks your project faces and how to mitigate them."}),Object(k.jsx)(A,{children:"Note: This tool does not save any data - it is intended as a teaching tool for showing how to brainstorm software security threats. While using this website, make sure to separately write down any information you would like to save for later."})]})}var C=n(32),z=n(195),F=n(187),T=n(206),P=n(191),D=n(207),I=n(208),L=n(189),M=n(196),q=n(68),R=n.n(q),W=n(93),_=n.n(W),B=n(24),E={OutOfScope:{name:"Out of Scope",description:"Our system interacts with this component, but we are not responsible for securing it."},AzureResource:{name:"Azure Resource",description:"This component is an Azure Resource itself (e.g. a CosmosDB database) or is built on one (e.g. an API built on App Service)."},MyCodeRunsHere:{name:"My Code Runs Here",description:"Code you or your team wrote runs on this resource."},ActsAsAClient:{name:"Acts as a Client",description:"This component connects to other components"},ActsAsAServer:{name:"Acts as a Server",description:"Other components connect to this component"}},Y=Object.values(E);function H(e){var t=a.useState(void 0),n=Object(c.a)(t,2),s=n[0],r=n[1];return Object(k.jsx)(a.Fragment,{children:Object(k.jsx)("form",{onSubmit:function(t){void 0!==s&&(e.handleSubmit(s),r(void 0)),t.preventDefault()},children:Object(k.jsxs)(z.a,{container:!0,spacing:2,children:[Object(k.jsx)(z.a,{item:!0,xs:8,children:Object(k.jsx)(F.a,{id:"standard-basic",label:"Component Name",variant:"standard",required:!0,fullWidth:!0,value:null!==s&&void 0!==s?s:"",onChange:function(e){return r(e.target.value)}})}),Object(k.jsx)(z.a,{item:!0,xs:4,children:Object(k.jsx)(g.a,{variant:"contained",type:"submit",children:"Add Component"})})]})})})}function N(e){var t=Object(B.a)();return Object(k.jsxs)(a.Fragment,{children:[Object(k.jsx)(x.a,{variant:"h6",gutterBottom:!0,children:"Add Components"}),Object(k.jsx)("p",{children:"List the high-level components of the system you are building - these could be a web server, a database, a load balancer, etc."}),Object(k.jsx)(T.a,{children:e.components.map((function(n){var a;return Object(k.jsx)(m.a,{variant:"outlined",sx:{marginBottom:1},children:Object(k.jsx)(P.a,{secondaryAction:Object(k.jsx)(D.a,{edge:"end","aria-label":"delete",onClick:function(){e.removeComponent(n)},children:Object(k.jsx)(R.a,{})}),children:Object(k.jsxs)(z.a,{container:!0,children:[Object(k.jsx)(z.a,{item:!0,xs:12,children:Object(k.jsx)(I.a,{primary:n})}),Object(k.jsx)(z.a,{item:!0,xs:7,children:Object(k.jsxs)(z.a,{container:!0,direction:"row",alignItems:"center",children:[Object(k.jsx)(z.a,{item:!0,xs:11,children:Object(k.jsx)(L.a,{multiple:!0,id:"tags-standard",options:Y,value:null!==(a=e.componentTraitsMap.get(n))&&void 0!==a?a:[],getOptionLabel:function(e){return e.name},renderInput:function(e){return Object(k.jsx)(F.a,Object(C.a)(Object(C.a)({},e),{},{variant:"standard",label:"Traits",placeholder:"Traits"}))},renderOption:function(e,n){return Object(k.jsx)("li",Object(C.a)(Object(C.a)({},e),{},{children:Object(k.jsxs)(h.a,{sx:{flexGrow:1,"& span":{color:"light"===t.palette.mode?"#586069":"#8b949e"}},children:[n.name,Object(k.jsx)("br",{}),Object(k.jsx)("span",{children:n.description})]})}))},onChange:function(t,a){e.setComponentTraits(n,a)}})}),Object(k.jsx)(z.a,{item:!0,children:Object(k.jsx)(h.a,{sx:{marginTop:"1em"},children:Object(k.jsx)(M.a,{title:"Add relevant traits to improve the suggestions provided in the discussion guide.",children:Object(k.jsx)(_.a,{})})})})]})})]})})})}))}),Object(k.jsx)(H,{handleSubmit:e.addComponent})]})}function U(e){var t=a.useState(null),n=Object(c.a)(t,2),s=n[0],r=n[1];return Object(k.jsx)(a.Fragment,{children:Object(k.jsx)("form",{children:Object(k.jsxs)(z.a,{container:!0,spacing:2,children:[Object(k.jsx)(z.a,{item:!0,xs:6,children:Object(k.jsx)(L.a,{onChange:function(e,t){r(t)},value:s,disablePortal:!0,options:e.componentChoices,renderInput:function(e){return Object(k.jsx)(F.a,Object(C.a)(Object(C.a)({},e),{},{label:"Source Component",required:!0}))}})}),Object(k.jsx)(z.a,{item:!0,xs:6,children:Object(k.jsx)(L.a,{onChange:function(t,n){var a;a=n,null!==s&&null!==a&&(e.handleSubmit(s,a),r(null),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},disabled:null===s,value:null,disablePortal:!0,options:e.componentChoices.filter((function(e){return e!==s})).filter((function(t){return null==s||!function(t,n){var a,s;return(null===(a=e.dataFlows.get(t))||void 0===a?void 0:a.has(n))||(null===(s=e.dataFlows.get(n))||void 0===s?void 0:s.has(t))}(s,t)})),renderInput:function(e){return Object(k.jsx)(F.a,Object(C.a)(Object(C.a)({},e),{},{label:"Destination Component",required:!0}))}})})]})})})}function G(e){return Object(k.jsxs)(a.Fragment,{children:[Object(k.jsx)(x.a,{variant:"h6",gutterBottom:!0,children:"Add Data Flows"}),Object(k.jsx)("p",{children:"Describe which components share data with which other components - for example, a browser shares data with a web server, and a web server might share data with a database, etc."}),Object(k.jsx)("p",{children:"For simplicity, all data flows are assumed to be bidirectional."}),Object(k.jsx)(T.a,{children:Array.from(e.dataFlows).map((function(t){var n=Object(c.a)(t,2),a=n[0],s=n[1];return Array.from(s).map((function(t){return Object(k.jsx)(P.a,{secondaryAction:Object(k.jsx)(D.a,{edge:"end","aria-label":"delete",onClick:function(){e.removeFlow(a,t)},children:Object(k.jsx)(R.a,{})}),children:Object(k.jsx)(I.a,{primary:"".concat(a," <-> ").concat(t)})})}))}))}),Object(k.jsx)(U,{componentChoices:e.components,dataFlows:e.dataFlows,handleSubmit:e.addFlow})]})}var Q=n(209),V=n(193),J=n(94),K=n.n(J);function X(e){return Object(k.jsx)(m.a,{variant:"outlined",sx:{mb:1,p:.5,px:1.5},children:Object(k.jsxs)(x.a,{sx:{mt:1,mb:1},color:"text.secondary",children:[Object(k.jsx)(K.a,{sx:{mr:1,verticalAlign:"middle"}}),e.children]})})}var Z=n(95),$=n.n(Z);function ee(e){return Object(k.jsx)(m.a,{variant:"outlined",sx:{mb:1,p:.5,px:1.5},children:Object(k.jsxs)(x.a,{sx:{mt:1,mb:1},color:"text.secondary",children:[Object(k.jsx)($.a,{sx:{mr:1,verticalAlign:"middle"}}),e.children]})})}function te(e,t){var n;return new Set(Array.from(null!==(n=e.get(t))&&void 0!==n?n:[],(function(e,t){return e.name})))}function ne(e){var t=a.useState(0),n=Object(c.a)(t,2),s=n[0],r=n[1],i=a.useState(new Set),o=Object(c.a)(i,2),l=o[0],d=o[1],u=function(){r((function(e){return e+1}))},m=function(){r((function(e){return e-1}))},p=function(e){return l.has(e)},f=function(e){var t=new Set(l);p(e)?t.delete(e):t.add(e),d(t)};return Object(k.jsx)(a.Fragment,{children:Object(k.jsx)(j.a,{nonLinear:!0,activeStep:s,orientation:"vertical",children:e.steps.map((function(t,n){return Object(k.jsxs)(b.a,{completed:p(n),children:[Object(k.jsx)(Q.a,{onClick:function(){r(n)},children:t.label}),Object(k.jsxs)(V.a,{children:[t.content,Object(k.jsx)(h.a,{sx:{mb:2},children:Object(k.jsxs)("div",{children:[p(n)?Object(k.jsxs)(a.Fragment,{children:[Object(k.jsx)(g.a,{onClick:function(){f(n)},sx:{mt:1,mr:1},children:"Unmark Completed"}),n<e.steps.length-1&&Object(k.jsx)(g.a,{onClick:u,sx:{mt:1,mr:1},children:"Continue"})]}):Object(k.jsxs)(a.Fragment,{children:[Object(k.jsxs)(g.a,{variant:"contained",onClick:function(){f(n),n<e.steps.length-1&&u()},sx:{mt:1,mr:1},children:["Complete ",n<e.steps.length-1?"and Continue":""]}),n<e.steps.length-1&&Object(k.jsx)(g.a,{onClick:u,sx:{mt:1,mr:1},children:"Continue"})]}),Object(k.jsx)(g.a,{disabled:0===n,onClick:m,sx:{mt:1,mr:1},children:"Back"})]})})]})]},t.label)}))})})}function ae(e){return Object(k.jsxs)(a.Fragment,{children:[Object(k.jsx)(x.a,{variant:"h6",gutterBottom:!0,children:"Discussion Guide"}),Object(k.jsx)("p",{children:"Now that you've described your system, you're ready to brainstorm what actions attackers might try in order to break in to your system. Grab some teammates and think about the following possiblities. Remember, this is brainstorming - all ideas are fair game, even if you later decide a possible attack is too unlikely or too low impact to do anything about."}),Object(k.jsx)(ne,{steps:(t=e.components,n=e.componentTraitsMap,s=e.dataFlows,t.flatMap((function(e){var t,a,r=te(n,e),i=r.has(E.OutOfScope.name)?[]:[{label:"".concat(e,": Tampering"),content:Object(k.jsxs)(x.a,{children:["An attacker might try to tamper with this component in order to accomplish their goals.",Object(k.jsxs)("p",{children:["Examples include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker might try to alter data in their database (e.g. to increase an account balance)."}),Object(k.jsx)("li",{children:"An attacker might try to reconfigure a load balancer in order to point route requests to a system under their control."}),Object(k.jsx)("li",{children:"An attacker might try to delete or destroy a resource in order to take a system offline."})]})]}),Object(k.jsx)(X,{children:"Consider using an access control mechanism to restrict acess to this resource. Some examples include operating system user permissions, network access control lists, or cloud provider access mangement tools. Only grant access to users and systems that need access, and grant as little access as possible."}),r.has(E.AzureResource.name)&&Object(k.jsx)(X,{children:"You indicated that this is an Azure resource - Azure RBAC allows one to configure fine-grained control over which users or systems have the ability to administer Azure resources - consider granting the narrowest possible roles to the users and systems that need to manage this resource. In addition, some Azure resources offer additional tools for restricting access, such as VNet support, data plane role-based access control (such as for Cosmos DB), or IP address filtering."})]})},{label:"".concat(e,": Repudiation"),content:Object(k.jsxs)(x.a,{children:["An attacker might try to make an action and later claim they did not take that action, or take that action without having been discovered.",Object(k.jsxs)("p",{children:["Examples include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker might try to spend a gift card more than once."}),Object(k.jsx)("li",{children:"An attacker might try to exploit a system without leaving any traces behind."})]})]}),Object(k.jsxs)(X,{children:["Consider setting up a logging mechanism for this component, such that you can understand what transpired after the fact. There are a couple types of logs that can be useful:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"Application Logs. Typically unstructured logs that print diagnostic information about errors, warnings, or trace messages emitted while your application is running."}),Object(k.jsx)("li",{children:"Request Logs. Typically a structured format that is more condensed than application logs, request logs typically record metadata about particular requests your application received, and what happened - these might include the IP address of the sender, the HTTP response code that the server responded with, how long the request took, etc."})]})]}),r.has(E.AzureResource.name)&&Object(k.jsxs)(X,{children:["You indicated that this is an Azure resource - many Azure resources offer ",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/platform-logs-overview",children:"built-in support for collecting diagostic logs."})," Consider enabling diagostic logging for this resource."]})]})},{label:"".concat(e,": Information Disclosure"),content:Object(k.jsxs)(x.a,{children:["An attacker might try to extract data they should not have access to from this component.",Object(k.jsxs)("p",{children:["Examples include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker gains access to the datacenter where this component is housed and walks away with the underlying physical storage."}),Object(k.jsx)("li",{children:"An attacker gains access to this component by exploiting a vulnerability in the OS or other software and extracts confidential information stored on disk."}),Object(k.jsx)("li",{children:"An attacker gains access to this component by exploiting incorrect access control settings and extracts confidential information from this resource."})]})]}),Object(k.jsx)(X,{children:"Consider using an access control mechanism to restrict acess to this resource. Some examples include operating system user permissions, network access control lists, or cloud provider access mangement tools. Only grant access to users and systems that need access, and grant as little access as possible."}),Object(k.jsxs)(X,{children:["For particularly sensitive / high-value information stored at rest, consider whether additional defenses may be appropriate. For example:",Object(k.jsxs)("ul",{children:[Object(k.jsxs)("li",{children:["When storing passwords: consider whether you can avoid storing passwords at all by using a third-party authentication provider instead (like ",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview",children:" Microsoft Identity Platform"}),"). If you must store passwords, follow guidelines for doing so safely (like",Object(k.jsx)("a",{href:"https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html",children:"OWASP's Password Cheat Sheet"}),")"]}),Object(k.jsxs)("li",{children:["When storing other confidential information: consider encrypting the sensitive information before storing it, which would make it much more difficult for an attacker to make use of any data they gain acess to. Follow guidelines like",Object(k.jsx)("a",{href:"https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",children:"OWASP's Cryptographic Storage cheat sheet"}),", and/or regulatory standards like PCI-DSS, HIPAA, or FedRAMP that might apply to your use case."]})]})]}),r.has(E.AzureResource.name)&&Object(k.jsxs)(X,{children:["You indicated that this is an Azure resource - Many Azure resources offer tools for controlling which other systems can access access data, such as VNet support, data plane role-based access control (such as for Cosmos DB), IP address filtering, and others. Consider how you might leverage these to limit access to this resource to just those users or systems who need it.",Object(k.jsxs)("p",{children:["Azure offers ",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/security/fundamentals/encryption-overview",children:"a varity of tools to help you encrypt data"}),", both 'server side' (encryption at rest provided transparently by Azure resources for you) and 'client side' (encryption your application performs before storing data)."]})]})]})},{label:"".concat(e,": Denial of Service"),content:Object(k.jsxs)(x.a,{children:["An attacker might try to cause this component to stop serving legitimate customers/users.",Object(k.jsxs)("p",{children:["Examples include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker (or even an overzelous legitimate user) might try to flood this component with more requests or network traffic than it can handle."}),Object(k.jsxs)("li",{children:["An attacker might try to exhaust resources provided by this component. They might:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"Send requests that are very large, to consume RAM."}),Object(k.jsx)("li",{children:"Send requests to your API that causes your services to download very large files (e.g. if your API takes a URL as input) to exhaust disk space."}),Object(k.jsx)("li",{children:"Consume available CPU by mining for bitcoin (if your component runs code provided by users, e.g. like CI/CD tools such as Github Actions)."})]})]})]})]}),Object(k.jsxs)(X,{children:["Consider limiting how many resources any given user of this component may consume. Some options to consider include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"Limiting how large requests to this component may be, in terms of total size (bytes), number of items (for APIs accepting lists of items), or both."}),Object(k.jsx)("li",{children:"Limiting how often a given user is allowed to invoke your API and returning throttling errors (e.g. HTTP 429) when the limit is exceeded."}),Object(k.jsx)("li",{children:"Use a DDoS protection service provider in front of this component in order to defend against excessive network traffic."})]})]}),r.has(E.AzureResource.name)&&Object(k.jsxs)(X,{children:["You indicated that this is an Azure resource - Azure offers a varity of tools to help defend against denial of service attacks, including:",Object(k.jsxs)("ul",{children:[Object(k.jsxs)("li",{children:[Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/api-management/api-management-key-concepts",children:"Azure API Management"})," provides configurable rules for limiting how often a given subscriber may call an API."]}),Object(k.jsxs)("li",{children:["Azure Front Door provides a ",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/frontdoor/front-door-ddos",children:"variety of DDoS protections built-in"})," that can help stop floods of illegtimate network traffic before they arrive at your system.",Object(k.jsx)("ul",{children:Object(k.jsxs)("li",{children:[Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/web-application-firewall/overview",children:"Azure Web Application Firewall"})," (which can integrate with Azure Front Door) also offers rules for rate limiting requests by client IP address."]})})]})]})]})]})},{label:"".concat(e,": Escalation of Privilege"),content:Object(k.jsxs)(x.a,{children:["An attacker might try to take advantage of this component in order to gain access they should not have.",Object(k.jsxs)("p",{children:["Examples include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker might try to trick this component into taking actions that it shouldn't (for example, an attacker might include SQL commands in API inputs hoping that this component sends those commands to a database improperly)."}),Object(k.jsx)("li",{children:"An attacker might try to exploit vulnerabilities in process running as an administrator/root in order to gain administrator access to a system."}),Object(k.jsx)("li",{children:"After gaining access to a system, an attacker might try to find credentials stored on the system that grant the attacker more access (either access to more systems they could not access before, or higher privilege access to systems the attacker could already access)."})]})]}),Object(k.jsxs)(X,{children:["Common ways to mitigate escalation of privilege attacks include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"Taking care to keep commands separate from data, particularly for databases. For SQL, a great way to do this is through parameterized queries ( aka. prepared statements)."}),Object(k.jsx)("li",{children:"Validate inputs carefully before acting on them."}),Object(k.jsxs)("li",{children:["When this component calls another component on behalf of a client, indicate to the downstream system who the call is being made on behalf of; this allows the downstream system to determine whether the originator of the request is authorized (in addition to checking that this component is allowed to) make the call. For more specific examples, see",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow",children:"Microsoft Identity Platform"})," on-behalf-of flow and the ",Object(k.jsx)("a",{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html",children:"AWS IAM external ID"})," field."]}),Object(k.jsx)("li",{children:"Run this component with the least privilege necessary for it to function. For processes on a host, run as non-administrative system user having minimal privileges; for cloud services, use roles granting as few permissions as possible."})]})]}),r.has(E.AzureResource.name)&&Object(k.jsxs)(X,{children:["You indicated that this is an Azure resource - as an example of how to keep commands separate from data, if this component accesses Cosmos DB using the SQL API, consider using ",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/cosmos-db/sql/sql-query-parameterized-queries",children:"CosmosDB parameterized queries."})]})]})}],o=function(e,t){var a=te(n,e),s=te(n,t),r=a.has(E.ActsAsAClient.name),i=a.has(E.ActsAsAServer.name),o=s.has(E.ActsAsAClient.name),c=s.has(E.ActsAsAServer.name);return Object(k.jsxs)(x.a,{children:["An attacker might try to pretend to be '",e,"' in order to gain access they should not have.",Object(k.jsxs)("p",{children:["Examples include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker might try to make API calls while saying they are someome they are not (e.g. by spoofing their IP address)."}),Object(k.jsx)("li",{children:"An attacker might try to hijack a DNS name such that it points to a system under the attackers' control."})]})]}),Object(k.jsxs)(X,{children:["Consider having ",t," require that ",e," prove its identity using a strong identification mechanism that is difficult to forge. For example:",Object(k.jsxs)("ul",{children:[o&&Object(k.jsxs)("li",{children:["You indicated that ",t," acts as a client - consider having ",t," only connect to ",e,"\xa0using TLS and require that the server prove its identity with a valid certificate signed by a trusted CA."]}),c&&Object(k.jsxs)("li",{children:["You indicated that ",t," acts as a server - consider having ",t," require that",e," prove that it knows a secret having enough entropy that it would be impractical for an attacker to guess (e.g. an access token sent over TLS or a TLS client certificate)."]}),Object(k.jsxs)("li",{children:["If ",e," and ",t," exchange messages outside of a server/client relationship (e.g. via a message broker, or a non-TCP channel), consider having both components require messages to be signed with a\xa0",Object(k.jsx)("a",{href:"https://en.wikipedia.org/wiki/Message_authentication_code",children:"message authentication code"})," or\xa0",Object(k.jsx)("a",{href:"https://en.wikipedia.org/wiki/Digital_signature",children:"digital signature"}),"."]})]})]}),i&&a.has(E.AzureResource.name)&&Object(k.jsxs)(X,{children:["You indicated that at ",e," is an Azure resource, and that it acts as a server - some Azure services offer the ability to manage TLS certificates for your custom domains (and their corresponding private keys) for you automatically, such as\xa0",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-certificate#create-a-free-managed-certificate",children:"App Service"})," and\xa0",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/frontdoor/standard-premium/how-to-configure-https-custom-domain#azure-managed-certificates",children:"Front Door"}),"."]}),r&&a.has(E.AzureResource.name)&&s.has(E.AzureResource.name)&&Object(k.jsxs)(X,{children:["You indicated that ",e," acts as a client, it is an Azure resource, and that ",t," is also an Azure resource - many Azure services make it easy for your code to authenticate to other Azure resources by providing\xa0",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview",children:"managed identity credentials"})," to your code, which ",e," can use when connecting to ",t,"."]}),r&&s.has(E.AzureResource.name)&&Object(k.jsxs)(X,{children:["You indicated that ",e," acts as a client, and that ",t," is also an Azure resource - some Azure resources can also help you authenticate clients, such as\xa0",Object(k.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/app-service/overview-authentication-authorization",children:"App Service built-in authentication and authorization."})]}),!(s.has(E.ActsAsAServer.name)||s.has(E.ActsAsAClient.name))&&Object(k.jsxs)(X,{children:["To get better suggestions here about how to verify ",e,"'s identity, add the '",E.ActsAsAServer.name,"' and/or '",E.ActsAsAClient.name,"' traits to ",t," and ",e,"."]})]})},c=Array.from(null!==(t=null===(a=s.get(e))||void 0===a?void 0:a.values())&&void 0!==t?t:[]).flatMap((function(t){return[{label:"".concat(e," <-> ").concat(t,": Spoofing of '").concat(e,"' identity"),content:o(e,t)},{label:"".concat(e," <-> ").concat(t,": Spoofing of '").concat(t,"' identity"),content:o(t,e)},{label:"".concat(e," <-> ").concat(t,": Tampering"),content:Object(k.jsxs)(x.a,{children:["An attacker might try to alter information as it flows between these components (for example, as messages transit the public internet).",Object(k.jsxs)("p",{children:["Examples include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker might try to alter the content of a web site as it flows over a network in order to censor speech."}),Object(k.jsx)("li",{children:"An attacker might try to alter the content of a web site as it flows over a network in order to insert malware (like a bitcoin miner)."}),Object(k.jsx)("li",{children:"An attacker might try to alter the content of a library binary as it flows over a network in order to insert malware (like a reverse shell)."})]})]}),Object(k.jsxs)(X,{children:["Consider having ",e," and ",t," use a security control that assures the integrity of messages that they exchange such that any attempt at tampering may be detected. Examples include:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"For TCP connections, TLS is a good way to protect the integrity & authenticity of messages that are exchanged"}),Object(k.jsx)("li",{children:"For UDP messages, dTLS is a good way to integrity & authenticity of messages that are exchanged in a similar manner as TLS."}),Object(k.jsxs)("li",{children:["If these components exchange messages outside of a server/client relationship (e.g. via a message broker, or a non-TCP channel), consider having both components require messages to be signed with a\xa0",Object(k.jsx)("a",{href:"https://en.wikipedia.org/wiki/Message_authentication_code",children:"message authentication code"})," or\xa0",Object(k.jsx)("a",{href:"https://en.wikipedia.org/wiki/Digital_signature",children:"digital signature"}),"."]})]})]}),Object(k.jsxs)(ee,{children:["When checking the integrity of messages exchanged over an untrusted channel, make sure that the expected digest value either comes from a trusted source over a separate trusted channel or is authenticated using a strong authentication mechanism.",Object(k.jsxs)("p",{children:["For example, if a message and a SHA256 digest of the message's content were sent together over an untrusted channel, and attacker could easily recompute the correct SHA256 to send alongside an altered copy of a message, and the receiver would not be able to detect that the message was altered. Much better approaches would be to attach a ",Object(k.jsx)("a",{href:"https://en.wikipedia.org/wiki/Message_authentication_code",children:"message authentication code"})," or\xa0",Object(k.jsx)("a",{href:"https://en.wikipedia.org/wiki/Digital_signature",children:"digital signature"})," to the message instead (either of which are much more difficult for an attacker to forge), or to send the expected SHA256 digest over a separate, trusted channel (e.g. over a separate connection protected with TLS)."]})]})]})},{label:"".concat(e," <-> ").concat(t,": Information Disclosure"),content:Object(k.jsxs)(x.a,{children:["An attacker might try to spy on information as it flows between these components (for example, as messages transit the public internet).",Object(k.jsxs)("p",{children:["For example:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker might try to read the contents of network packets flowing through a router that they previously compromised."}),Object(k.jsx)("li",{children:"An attacker might try to read the contents of environment variables passed from one process to another."}),Object(k.jsx)("li",{children:"An attacker might try to read the contents data sent over a pipe from one process to another."}),Object(k.jsx)("li",{children:"An attacker might try to attach a bus sniffer to a hardware bus connecting multiple integrated circuits on a circuit board to extract confidential keys or secrets sent between them."})]})]}),Object(k.jsxs)(X,{children:["Consider having ",e," and ",t," protect the contents of messages exchanged between them using a security control that provides confidentiality (e.g. encryption). For example:",Object(k.jsxs)("ul",{children:[Object(k.jsxs)("li",{children:["When using TCP, TLS provides confidentiality through encryption. See",Object(k.jsx)("a",{href:"https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",children:"OWASP's Transport Layer Protection cheat sheet"})," for specific guidance."]}),Object(k.jsx)("li",{children:"When using UDP, dTLS provides confidentiality through encryption similar to that of TLS."})]})]}),Object(k.jsx)(ee,{children:"When establishing encryption keys with a remote system, be mindful of how certain you are that you established an encrypted connection with a system that you trust. For example, even when using TLS to encrypt messages sent over a network, if the remote system is not properly authenticated first by verifying the certificate they present, then an attacker can simply spoof the identity of the remote system in order to trick the client into sharing encryption keys with them."})]})},{label:"".concat(e," <-> ").concat(t,": Denial of Service"),content:Object(k.jsxs)(x.a,{children:["An attacker might try to disrupt the exchange of information between these components (for example, as messages transit the public internet).",Object(k.jsxs)("p",{children:["For example:",Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:"An attacker might try to send large volumes of data over a network in order to delay legitimate messages from getting through."}),Object(k.jsx)("li",{children:"An attacker (or even someone making a mistake) might try to disconnect a network route between two components in order to prevent them from exchanging information."})]})]}),Object(k.jsxs)(X,{children:["Typical strategies for defending against excessive network traffic saturating a data link include placing high capacity traffic filters in front of finite capacity data links in order to drop illegtimate packets before they consume capacity of the backbone link. DDoS protection services (such as Microsft, CloudFlare, AWS, etc.) typically place many such traffic filters around the globe and use DNS to route clients to the nearest one in order to defend their networks.",Object(k.jsx)("p",{children:"Consider what would happen in the event of an accidental network disruption between these components - would these components be able to fail over to a separate redundant network link? Would these components be able to fail over to separate redundant instances (e.g. database failover)? Is your application designed such that network errors would be detected and traffic shifted to healthy instances (e.g. within a data center via a load balancer, or cross-region via a global router like DNS)?"})]})]})}]}));return i.concat(c)})))})]});var t,n,s}function se(){return Object(k.jsxs)(x.a,{variant:"body2",color:"text.secondary",align:"center",children:["Copyright \xa9 ",Object(k.jsx)(f.a,{color:"inherit",href:"https://www.microsoft.com/",children:"Microsoft"})," ",(new Date).getFullYear(),"."]})}var re=["Intro","Components","Data Flows","Discussion Guide"];function ie(){var e=a.useState(0),t=Object(c.a)(e,2),n=t[0],s=t[1],r=a.useState([]),f=Object(c.a)(r,2),y=f[0],v=f[1],w=a.useState(new Map),A=Object(c.a)(w,2),C=A[0],z=A[1],F=a.useState(new Map),T=Object(c.a)(F,2),P=T[0],D=T[1],I=function(e,t){var n=new Map(Array.from(C,(function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return[n,Array.from(a)]})));void 0!==t?n.set(e,t):n.delete(e),z(n)},L=function(){return new Map(Array.from(P,(function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return[n,new Set(a)]})))},M=function(e,t){var n,a;return(null===(n=P.get(e))||void 0===n?void 0:n.has(t))||(null===(a=P.get(t))||void 0===a?void 0:a.has(e))};return Object(k.jsxs)(o.a,{theme:O,children:[Object(k.jsx)(i.a,{}),Object(k.jsx)(l.a,{position:"absolute",color:"default",elevation:0,sx:{position:"relative",borderBottom:function(e){return"1px solid ".concat(e.palette.divider)}},children:Object(k.jsx)(u.a,{children:Object(k.jsx)(x.a,{variant:"h6",color:"inherit",noWrap:!0,children:"Tension Wrench - Learn to Defend against Hackers"})})}),Object(k.jsxs)(d.a,{component:"main",maxWidth:"lg",sx:{mb:4},children:[Object(k.jsxs)(m.a,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[Object(k.jsx)(j.a,{activeStep:n,sx:{pt:3,pb:5},children:re.map((function(e){return Object(k.jsx)(b.a,{children:Object(k.jsx)(p.a,{children:e})},e)}))}),Object(k.jsx)(a.Fragment,{children:Object(k.jsxs)(a.Fragment,{children:[[Object(k.jsx)(S,{}),Object(k.jsx)(N,{components:y,componentTraitsMap:C,addComponent:function(e){var t=new Set(y);t.add(e),v(Array.from(t.values())),I(e,[])},removeComponent:function(e){v(y.filter((function(t){return t!==e}))),function(e){var t=L();t.has(e)&&t.delete(e),Array.from(t.values()).forEach((function(t){t.delete(e)})),D(t)}(e),I(e,void 0)},setComponentTraits:I}),Object(k.jsx)(G,{components:y,dataFlows:P,addFlow:function(e,t){var n;if(!M(e,t)){var a=L();a.has(e)||a.set(e,new Set),null===(n=a.get(e))||void 0===n||n.add(t),D(a)}},removeFlow:function(e,t){var n,a;if(M(e,t)){var s=L();null===(n=s.get(e))||void 0===n||n.delete(t),null===(a=s.get(t))||void 0===a||a.delete(e),D(s)}}}),Object(k.jsx)(ae,{components:y,componentTraitsMap:C,dataFlows:P})][n],Object(k.jsxs)(h.a,{sx:{display:"flex",justifyContent:"flex-end"},children:[0!==n&&Object(k.jsx)(g.a,{onClick:function(){s(n-1)},sx:{mt:3,ml:1},children:"Back"}),n<re.length-1&&Object(k.jsx)(g.a,{variant:"contained",onClick:function(){s(n+1)},sx:{mt:3,ml:1},children:"Next"})]})]})})]}),Object(k.jsx)(se,{})]})]})}function oe(){return Object(k.jsx)(ie,{})}r.a.render(Object(k.jsxs)(o.a,{theme:O,children:[Object(k.jsx)(i.a,{}),Object(k.jsx)(oe,{})]}),document.querySelector("#root"))}},[[130,1,2]]]);
//# sourceMappingURL=main.58238f7e.chunk.js.map